"use strict";(self.webpackChunkfly_doc=self.webpackChunkfly_doc||[]).push([[82],{8474:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return u},contentTitle:function(){return i},metadata:function(){return c},toc:function(){return p},default:function(){return d}});var r=n(7462),a=n(3366),s=(n(7294),n(3905)),o=["components"],u={sidebar_position:5},i="http\u54cd\u5e94",c={unversionedId:"tutorial-architecture/http-response",id:"tutorial-architecture/http-response",isDocsHomePage:!1,title:"http\u54cd\u5e94",description:"\u62fc\u63a5\u5e76\u8fd4\u56dehttp\u62a5\u6587\u3002",source:"@site/docs/tutorial-architecture/http-response.md",sourceDirName:"tutorial-architecture",slug:"/tutorial-architecture/http-response",permalink:"/fly-doc/docs/tutorial-architecture/http-response",editUrl:"https://github.com/facebook/docusaurus/edit/master/website/docs/tutorial-architecture/http-response.md",version:"current",sidebarPosition:5,frontMatter:{sidebar_position:5},sidebar:"tutorialSidebar",previous:{title:"http\u89e3\u6790",permalink:"/fly-doc/docs/tutorial-architecture/http-parser"},next:{title:"\u5982\u4f55\u7ec4\u7ec7\u9879\u76ee",permalink:"/fly-doc/docs/manage-docs-versions"}},p=[],l={toc:p};function d(e){var t=e.components,n=(0,a.Z)(e,o);return(0,s.kt)("wrapper",(0,r.Z)({},l,n,{components:t,mdxType:"MDXLayout"}),(0,s.kt)("h1",{id:"http\u54cd\u5e94"},"http\u54cd\u5e94"),(0,s.kt)("p",null,"\u62fc\u63a5\u5e76\u8fd4\u56dehttp\u62a5\u6587\u3002"),(0,s.kt)("p",null,"\u8fd9\u91cc\u9876\u4e00\u4e2a\u4e00\u4e2a\u9ed8\u8ba4\u62a5\u6587\u7ed3\u6784\uff0c\u5176\u4ed6\u62a5\u6587\u90fd\u5728\u6b64\u7ed3\u6784\u4e0a\u66f4\u6539\u3002"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-typescript"},"export class DefaultHeader {\n  public code = 200;\n  public status = 'OK';\n  public httpVersion = 'HTTP/1.1';\n  public headers: Headers = new Map<any, any>();\n\n  constructor(request: Request) {\n    if (!(request.method === 'OPTIONS')) {\n      this.headers.set('Content-Type', 'text/plain; charset=UTF-8');\n    }\n  }\n}\n")),(0,s.kt)("p",null,"sendText\u51fd\u6570\u5b9e\u73b0\u8fd4\u56de\u54cd\u5e94\uff0c\u8fd9\u91cc\u9700\u8981\u83b7\u53d6\u54cd\u5e94\u4f53\u7684\u5b57\u8282\u5927\u5c0f\uff0c\u5e76\u8bbe\u7f6eContent-Length\u5b57\u6bb5\u3002"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-typescript"},"function sendText(text: string | undefined) {\n    defaultHeader.headers.set(\n      'Content-Length',\n      Buffer.byteLength(text, 'utf-8'),\n    );\n    socket.write(spliceHeader(defaultHeader) + '\\r\\n' + text);\n  \n  socket.end();\n}\n")),(0,s.kt)("p",null,"spliceHeader\u5c06defaultHeader\u5206\u89e3\u6210\u5b57\u7b26\u4e32"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-typescript"},"export function spliceHeader(defaultHeader: DefaultHeader) {\n  let string = `${defaultHeader.httpVersion} ${defaultHeader.code} ${defaultHeader.status}\\r\\n`;\n  defaultHeader.headers.forEach((value, key) => {\n    string += `${key}:${value}\\r\\n`;\n  });\n  return string;\n}\n")))}d.isMDXComponent=!0}}]);